<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Perplexity</title>
<meta name="description" content="An amazing website.">


  <meta name="author" content="Your Name">
  


<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Perplexity">
<meta property="og:title" content="Perplexity">
<meta property="og:url" content="http://blog.inductorsoftware.com/Perplexity/home/pxhowto/pxHowTo070ActionVerbs/">


  <meta property="og:description" content="An amazing website.">











  

  


<link rel="canonical" href="http://blog.inductorsoftware.com/Perplexity/home/pxhowto/pxHowTo070ActionVerbs/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Your Name",
      "url": "http://blog.inductorsoftware.com/Perplexity/home/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/Perplexity/home/feed.xml" type="application/atom+xml" rel="alternate" title="Perplexity Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/Perplexity/home/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--delphin_page wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/Perplexity/home/"><img src="/Perplexity/home/assets/images/Delph-In.png" alt="Perplexity"></a>
        
        <a class="site-title" href="/Perplexity/home/">
          Perplexity
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://blog.inductorsoftware.com/Perplexity/home/devOverview">Home</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle Menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Developer Tutorial Overview</span>
        

        
        <ul>
          
            <li><a href="/Perplexity/home/devOverview/">Overview</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">MRS Conceptual</span>
        

        
        <ul>
          
            <li><a href="/Perplexity/home/mrscon/devhowto0010MRS/">Minimal Recursion Semantics (MRS)</a></li>
          
            <li><a href="/Perplexity/home/mrscon/devhowto0020WellFormedTree/">Well-Formed Trees</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">MRS Solver Conceptual</span>
        

        
        <ul>
          
            <li><a href="/Perplexity/home/devcon/devcon0000Overview/">Overview</a></li>
          
            <li><a href="/Perplexity/home/devcon/devcon0010MRSSolver/">Backtracking</a></li>
          
            <li><a href="/Perplexity/home/devcon/devcon0020MRSSolverSets/">Representing 'Together'</a></li>
          
            <li><a href="/Perplexity/home/devcon/devcon0030MRSSolverSolutionGroups/">Collective, Distributive, Cumulative</a></li>
          
            <li><a href="/Perplexity/home/devcon/devcon0050MRSSolverSolutionCombinations/">Combinations and Proper Responses</a></li>
          
            <li><a href="/Perplexity/home/devcon/devcon0060WhichParseAndTree/">Choosing a Parse and Tree</a></li>
          
            <li><a href="/Perplexity/home/devcon/devcon0070SentenceForce/">Sentence Types</a></li>
          
            <li><a href="/Perplexity/home/devcon/devcon0080ErrorsChoosingWhichFailure/">Choosing a Failure</a></li>
          
            <li><a href="/Perplexity/home/devcon/devcon0040MRSSolverSolutionGroupsAlgorithm/">A. Optimizing Coll/Dist/Cuml</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Using Perplexity</span>
        

        
        <ul>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo010Overview/">Overview</a></li>
          
            <li><a href="/Perplexity/home/pxHowTo/pxHowTo012Install/">Installing Perplexity</a></li>
          
            <li><a href="/Perplexity/home/pxHowTo/pxHowTo014HelloWorld/">Hello World</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo020ImplementAPredication/">Implementing a Predication</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo022Testing/">Testing</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo030InStylePredications/">In-Style Predications</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo040LiftStylePredications/">Lift-Style Predications</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo050EventPredications/">Event Predications</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo070ActionVerbs/" class="active">Verb Predications</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo082State/">Custom State</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo085Place/">Representing Places</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo090Prepositions/">Directional Propositions</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo100NonlogicalMeaning/">Solution Group Handlers and Non-logical Meaning</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo105GlobalCriteria/">Solution Group Handlers and Global Criteria</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo110HandlingTenses/">Handling Tenses</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo120ConceptsReferringExpressions/">Conceptual References</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo080QuantifiersAndDeterminers/">Quantifiers and Determiners</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo130OpenClassWords/">Centralizing Nouns/Adjectives</a></li>
          
            <li><a href="/Perplexity/home/pxhowto/pxHowTo025SStrings/">A. Generating English with S-strings</a></li>
          
        </ul>
        
      </li>
    
      <li>
        
          <span class="nav__sub-title">Perplexity Internals</span>
        

        
        <ul>
          
            <li><a href="/Perplexity/home/pxint/pxint0000Overview/">Overview</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0010PredicationContract/">The Predication Contract</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0020PythonBasics/">State and Python Basics</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0030ImplementPredication/">Implementing a Predication</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0040BuildSolver/">Initial Solver</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0050Conjunctions/">Solving Conjunctions</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0060ScopalArguments/">Solving Scopal Arguments</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0080SimplePropositions/">Propositions</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0090SimpleQuestions/">Questions</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0100SimpleCommands/">Commands</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0105ErrorsChoosingWhichFailure/">Choosing a Failure</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0110ErrorsReportingAFailure/">Naive Failure Text</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0120ErrorsConceptualFailures/">English Variable Domains</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0070GenerateMRSAndTrees/">Generating MRS and Trees</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint0071WhichParseAndTree/">Choosing a Parse and Tree</a></li>
          
            <li><a href="/Perplexity/home/pxint/pxint03000PythonDecorators/">A. Python Decorators</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    
    
    
    

    <div class="page__inner-wrap">
      
        <header>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <h2 id="action-verbs">Action Verbs</h2>
<p>All the predications we’ve dealt with so far have just been used to ask questions like “Is a file large?” or make propositions like “A file is large.” (which is just a kind of question in terms of the kind of response a person would expect). Now it is time to implement “action verbs” – verbs that actually <em>do</em> something to the system. Let’s implement “delete”.</p>

<p>“Delete” goes beyond asking questions about the state of the system. To implement it, we need to actually <em>modify</em> the state of the system. Since the current state of all parts of the system is represented by the <code class="language-plaintext highlighter-rouge">state</code> object, we’ll end up calling a method on that object in some form to delete a file.</p>

<p>If the user says, “delete a file”, this MRS and tree are produced (among others):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ "delete a file"
  TOP: h0
  INDEX: e2 [ e SF: comm TENSE: pres MOOD: indicative PROG: - PERF: - ]
  RELS: &lt; [ pronoun_q&lt;0:13&gt; LBL: h4 ARG0: x3 [ x PERS: 2 PT: zero ] RSTR: h5 BODY: h6 ]
          [ pron&lt;0:13&gt; LBL: h7 ARG0: x3 ]
          [ _delete_v_1&lt;0:6&gt; LBL: h1 ARG0: e2 ARG1: x3 ARG2: x8 [ x PERS: 3 NUM: sg IND: + ] ]
          [ _a_q&lt;7:8&gt; LBL: h9 ARG0: x8 RSTR: h10 BODY: h11 ]
          [ _file_n_of&lt;9:13&gt; LBL: h12 ARG0: x8 ARG1: i13 ] &gt;
  HCONS: &lt; h0 qeq h1 h5 qeq h7 h10 qeq h12 &gt; ]


               ┌────── pron(x3)
pronoun_q(x3,RSTR,BODY)          ┌────── _file_n_of(x8,i13)
                    └─ _a_q(x8,RSTR,BODY)
                                      └─ _delete_v_1(e2,x3,x8)
</code></pre></div></div>

<p>Let’s ignore the pronoun related predications and focus on <code class="language-plaintext highlighter-rouge">_delete_v_1(e2,x3,x8)</code>. We’re not going to handle any modifiers to it either, so we can ignore both <code class="language-plaintext highlighter-rouge">e2</code> and <code class="language-plaintext highlighter-rouge">x3</code> (since <code class="language-plaintext highlighter-rouge">x3</code> represents the pronoun). That leaves <code class="language-plaintext highlighter-rouge">x8</code>, which is the thing the user wants to delete.</p>

<p>We could try implementing <code class="language-plaintext highlighter-rouge">_delete_v_1</code> like the other single <code class="language-plaintext highlighter-rouge">x</code> predications we’ve built by calling the <code class="language-plaintext highlighter-rouge">combinatorial_predication_1()</code> helper. The problem is: <code class="language-plaintext highlighter-rouge">_delete_v_1</code> doesn’t support sets &gt; 1. “Delete” doesn’t make sense for a set of items “together”.  Deleting items together sounds dangerously like “deleting them in a transaction” which our file system can’t do.  Really, delete can only apply to one item at a time, and it shouldn’t support a “together” semantic unless it can really enforce it. So, it will use a different helper called, <code class="language-plaintext highlighter-rouge">individual_style_predication_1()</code> which ensures that only single individuals make it through, like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Predication(vocabulary, names=["_delete_v_1"])
def delete_v_1_comm(context, state, e_introduced_binding, x_actor_binding, x_what_binding):
    def criteria(value):
        # Only allow deleting files and folders that exist
        # value will not be a tuple since individual_style_predication_1() was used
        if value in ["file1.txt", "file2.txt", "file3.txt"]:
            return True

        else:
            context.report_error(["cantDo", "delete", x_what_binding.variable.name])

    def unbound_what():
        report_error(["cantDo", "delete", x_what_binding.variable.name])

    yield from individual_style_predication_1(context,
                                              state, 
                                              x_what_binding,
                                              criteria, unbound_what,
                                              ["cantXYTogether", "delete", x_what_binding.variable.name])
</code></pre></div></div>
<p>Note that <code class="language-plaintext highlighter-rouge">individual_style_predication_1()</code> has an extra argument at the end which is the error to report if it gets called with a set of more than one item.</p>

<p>So, this does <em>some</em> of the work we need: it will only succeed if the user asks to delete a file that exists, and it won’t allow phrases like “delete everything” that would produce an unbound <code class="language-plaintext highlighter-rouge">x8</code>. However, it won’t actually <em>delete anything</em> because there isn’t any code to do the deleting.</p>

<p><code class="language-plaintext highlighter-rouge">individual_style_predication_1()</code> yields a <code class="language-plaintext highlighter-rouge">state</code> object when <code class="language-plaintext highlighter-rouge">delete_v_1_comm</code> is successful. So, we could start by doing the actual delete when that function yields a value because it means everything has been checked and is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<p>Let’s imagine that we added a <code class="language-plaintext highlighter-rouge">state.delete_object()</code> to the <code class="language-plaintext highlighter-rouge">State</code> object that actually deletes a file and yields a new state with that file deleted. That approach could look like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Predication(vocabulary, names=["_delete_v_1"])
def delete_v_1_comm(context, state, e_introduced_binding, x_actor_binding, x_what_binding):
    def criteria(value):
        # Only allow deleting files and folders that exist
        # value will not be a tuple since individual_style_predication_1() was used
        if value in ["file1.txt", "file2.txt", "file3.txt"]:
            return True

        else:
            context.report_error(["cantDo", "delete", x_what_binding.variable.name])

    def unbound_what():
        context.report_error(["cantDo", "delete", x_what_binding.variable.name])

    for success_state in individual_style_predication_1(context,
                                                        state, 
                                                        x_what_binding,
                                                        criteria, 
                                                        unbound_what,
                                                        ["cantXYTogether", "delete", x_what_binding.variable.name]):
        object_to_delete = success_state.get_binding(x_what_binding.variable.name).value[0]
        yield success_state.delete_object(object_to_delete)        
</code></pre></div></div>

<p>This works because:</p>

<p>When <code class="language-plaintext highlighter-rouge">individual_style_predication_1()</code> yields a new state, it means this predication was successful. That happened because the <code class="language-plaintext highlighter-rouge">criteria()</code> function returned <code class="language-plaintext highlighter-rouge">true</code>. The new state has all the MRS variables set to the value that made the predication <code class="language-plaintext highlighter-rouge">true</code>, which means that the <code class="language-plaintext highlighter-rouge">x_what_binding</code> variable should now be set to the thing being deleted.</p>

<p>However, we need to be careful to ask for the value of the variable represented by <code class="language-plaintext highlighter-rouge">x_what_binding</code> <em>in the new state</em>. Remember that <code class="language-plaintext highlighter-rouge">state</code> objects are immutable, so we have to look at the <em>copy</em> being returned to get the new value of the variable. That’s what this line does:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>object_to_delete = success_state.get_binding(x_what_binding.variable.name).value[0]
</code></pre></div></div>

<p>This is basically the approach we are going to use, but we need some extra mechanisms to do it. The reason why is described next.</p>

<h3 id="operations">Operations</h3>
<p>Actions that modify anything in the world state besides an MRS variable are called an <code class="language-plaintext highlighter-rouge">Operation</code> in Perplexity.  They go beyond manipulating the MRS and actually affect the world the person is speaking about. Predications like <code class="language-plaintext highlighter-rouge">_delete_v_1</code> that want to modify the state of the world need to use an <code class="language-plaintext highlighter-rouge">Operation</code>.</p>

<p><code class="language-plaintext highlighter-rouge">Operations</code> are a way of recording what to do and then doing it later: Think of an <code class="language-plaintext highlighter-rouge">Operation</code> as a way to package up a method call into an object and then <em>later</em> ask it to execute.</p>

<p>An <code class="language-plaintext highlighter-rouge">Operation</code> is simply any Python class that includes this method:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def apply_to(self, state):

    ...
</code></pre></div></div>

<p>The constructor (i.e. the <code class="language-plaintext highlighter-rouge">__init__</code> method) packages up all the information needed to perform the operation later by storing them as members in the class. When it is time to actually perform the operation, <code class="language-plaintext highlighter-rouge">apply_to()</code> is called, and the <code class="language-plaintext highlighter-rouge">state</code> object that it should be applied to is passed in.</p>

<p>Here is an example of what a <code class="language-plaintext highlighter-rouge">DeleteOperation</code> could look like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class DeleteOperation(object):
    def __init__(self, value_to_delete):
        self.value_to_delete = value_to_delete

    def apply_to(self, state):
        state.file_system.delete_item(self.value_to_delete)
</code></pre></div></div>
<p>The <code class="language-plaintext highlighter-rouge">DeleteOperation</code> itself is very simple, it is really just remembering what to delete. When it is asked to <code class="language-plaintext highlighter-rouge">apply_to()</code>, it calls the method in the <code class="language-plaintext highlighter-rouge">state</code> object that actually deletes the file, in <em>that</em> state object (which might be different than the one it was added to).</p>

<p>To use the <code class="language-plaintext highlighter-rouge">DeleteOperation</code>, we create an instance of one and pass it to the <code class="language-plaintext highlighter-rouge">apply_operations()</code> method in the <code class="language-plaintext highlighter-rouge">State</code> object, like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>operation = DeleteOperation(new_state.get_binding(x_what_binding.variable.name).value[0])
new_state.apply_operations([operation])
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">apply_operations()</code> method takes a list of operations to apply, but in this case we’re only doing one. Those two lines of code record that we want to delete a particular file, but they don’t actually <em>do</em> it yet.  Later, when we have the final solution group, we can gather all of the <code class="language-plaintext highlighter-rouge">Operations</code> that were done to the solutions in the group and call <code class="language-plaintext highlighter-rouge">apply_operations()</code> on the one single state we want to represent the new world.</p>

<p>Doing things in this more roundabout way solves two problems. Recall that the solver builds a list of all solutions (conceptually) and then groups them into solution groups. We don’t want files <em>actually being deleted</em> during this phase because some of the solutions might not be used! Furthermore, each solution in a group will only have a subset of the files deleted. Using operations allows us to both delay state changes as well as apply them <em>all</em> to a single state which can represent the “new state of the world” once we know what to do.</p>

<p>Now we can write the basic implementation of “delete”:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Predication(vocabulary, names=["_delete_v_1"])
def delete_v_1_comm(context, state, e_introduced_binding, x_actor_binding, x_what_binding):
    def criteria(value):
        # Only allow deleting files and folders that exist
        # value will not be a tuple since individual_style_predication_1() was used
        if value in ["file1.txt", "file2.txt", "file3.txt"]:
            return True

        else:
            context.report_error(["cantDo", "delete", x_what_binding.variable.name])

    def unbound_what():
        context.report_error(["cantDo", "delete", x_what_binding.variable.name])

    for success_state in individual_style_predication_1(context,
                                                        state, 
                                                        x_what_binding,
                                                        criteria, 
                                                        unbound_what,
                                                        ["cantXYTogether", "delete", x_what_binding.variable.name]):
        object_to_delete = success_state.get_binding(x_what_binding.variable.name).value[0]
        operation = DeleteOperation(object_to_delete)
        yield success_state.apply_operations([operation])
</code></pre></div></div>

<p>The final step that merges together all the operations and applies them to a single state is done by Perplexity automatically at the end of <code class="language-plaintext highlighter-rouge">user_interface.default_loop()</code>. That’s where <code class="language-plaintext highlighter-rouge">DeleteOperation.apply_to()</code> gets called for every solution in the solution group.</p>

<h2 id="the-pron-predication">The pron() Predication</h2>
<p>The MRS we are working with is:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[ "delete a file"
  TOP: h0
  INDEX: e2 [ e SF: comm TENSE: pres MOOD: indicative PROG: - PERF: - ]
  RELS: &lt; [ pronoun_q&lt;0:13&gt; LBL: h4 ARG0: x3 [ x PERS: 2 PT: zero ] RSTR: h5 BODY: h6 ]
          [ pron&lt;0:13&gt; LBL: h7 ARG0: x3 ]
          [ _delete_v_1&lt;0:6&gt; LBL: h1 ARG0: e2 ARG1: x3 ARG2: x8 [ x PERS: 3 NUM: sg IND: + ] ]
          [ _a_q&lt;7:8&gt; LBL: h9 ARG0: x8 RSTR: h10 BODY: h11 ]
          [ _file_n_of&lt;9:13&gt; LBL: h12 ARG0: x8 ARG1: i13 ] &gt;
  HCONS: &lt; h0 qeq h1 h5 qeq h7 h10 qeq h12 &gt; ]


               ┌────── pron(x3)
pronoun_q(x3,RSTR,BODY)          ┌────── _file_n_of(x8,i13)
                    └─ _a_q(x8,RSTR,BODY)
                                      └─ _delete_v_1(e2,x3,x8)
</code></pre></div></div>

<p>… and <code class="language-plaintext highlighter-rouge">pron(x)</code> is the last predication to implement (<code class="language-plaintext highlighter-rouge">pronoun_q</code> is a quantifier that is implemented by the system). <code class="language-plaintext highlighter-rouge">pron(x)</code> is true when <code class="language-plaintext highlighter-rouge">x</code> is bound to an object that represents what the specified pronoun is <em>referring to</em>. The “specified pronoun” is determined by looking at the <a href="https://blog.inductorsoftware.com/Perplexity/home/mrscon/devhowto0010MRS">properties</a> for the <code class="language-plaintext highlighter-rouge">x</code> variable to determine if the pronoun is “you” (<code class="language-plaintext highlighter-rouge">PERS: 2</code> – second person), “him/her”(<code class="language-plaintext highlighter-rouge">PERS: 3</code> – third person), etc. If <code class="language-plaintext highlighter-rouge">x</code> is bound to an object that represents what that pronoun is referring to, it is <code class="language-plaintext highlighter-rouge">true</code>.</p>

<p>There were not any pronouns in our command “delete a file”, so where did the <code class="language-plaintext highlighter-rouge">pron</code> predication come from? In this case, the pronoun is an <em>implied</em> “you” since it is a command. I.e “(You) delete a large file”.  Because we are not including the notion of other people in the file system, the only pronouns we probably care to understand are “you” (“can you delete the file?” or the implied case above) and maybe “I” (“I want to delete a file”). For now, let’s just do “you” and fail otherwise.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Predication(vocabulary, names=["pron"])
def pron(context, state, x_who_binding):
    person = int(state.get_binding("tree").value[0]["Variables"][x_who_binding.variable.name]["PERS"])

    def bound_variable(value):
        if person == 2 and value == "computer":
            return True
        else:
            context.report_error(["dontKnowActor", x_who_binding.variable.name])

    def unbound_variable():
        if person == 2:
            yield "computer"
        else:
            context.report_error(["dontKnowActor", x_who_binding.variable.name])

    yield from combinatorial_style_predication_1(context, state, x_who_binding, bound_variable, unbound_variable)
</code></pre></div></div>

<p>To find out what pronoun is being referred to be <code class="language-plaintext highlighter-rouge">x</code>, we use a special variable binding that Perplexity puts in <code class="language-plaintext highlighter-rouge">state</code> called: <code class="language-plaintext highlighter-rouge">tree</code>.  This is not an MRS concept or feature, it is just a convenient place to keep the tree for predications that need to inspect it. The variables in the tree and their properties are accessed like a tree of dictionaries as shown above.</p>

<p>The 2nd person pronoun “you” will always refer to “the computer” so we represent it as a string “computer”. That is enough for this simple example.</p>

<p>Now we’ve implemented all the predications.  Just one final step is left.</p>

<h2 id="using-the-state-object">Using the State Object</h2>
<p>To make this run properly, we need to quit using hard-coded lists of files since we’re going to be deleting them. It is time to use a real <code class="language-plaintext highlighter-rouge">State</code> object to track state. The built-in Perplexity <code class="language-plaintext highlighter-rouge">State</code> object has a very simple default mechanism for tracking objects. In most cases, we would need to derive a new class from it to manage the state of an application in a richer way, but our examples are simple enough that we can use it as-is.</p>

<p>The important parts of the class for our purposes are below. A list of objects can be passed in the constructor and <code class="language-plaintext highlighter-rouge">State</code> will return them from <code class="language-plaintext highlighter-rouge">all_individuals()</code>. It is very simple:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class State(object):
    def __init__(self, objects):

        ...

        self.objects = objects

    ...
    
    def all_individuals(self):
        for item in self.objects:
            yield item

    ...
</code></pre></div></div>

<p>We need to change <code class="language-plaintext highlighter-rouge">file_n_of</code>, <code class="language-plaintext highlighter-rouge">large_a_1</code> and <code class="language-plaintext highlighter-rouge">delete_v_1_comm</code> to use the <code class="language-plaintext highlighter-rouge">state</code> object instead of hard-coding the list of files:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@Predication(vocabulary, names=["_file_n_of"])
def file_n_of(context, state, x_binding, i_binding):
    def bound_variable(value):
        if value in state.all_individuals():
            return True
        else:
            context.report_error(["notAThing", x_binding.value, x_binding.variable.name])
            return False

    def unbound_variable():
        yield from state.all_individuals()

    yield from combinatorial_style_predication_1(context, state, x_binding, bound_variable, unbound_variable)



@Predication(vocabulary,
             names=["_large_a_1"],
             handles=[("DegreeMultiplier", EventOption.optional)])
def large_a_1(context, state, e_introduced_binding, x_target_binding):
    # See if any modifiers have changed *how* large we should be
    degree_multiplier = degree_multiplier_from_event(state, e_introduced_binding)

    def criteria_bound(value):
        if degree_multiplier == 1 and value == "file2.txt" and "file2.txt" in state.all_individuals():
            return True

        else:
            context.report_error(["adjectiveDoesntApply", "large", x_target_binding.variable.name])
            return False

    def unbound_values():
        if criteria_bound("file2.txt"):
            yield "file2.txt"

    yield from combinatorial_style_predication_1(context, state, x_target_binding, criteria_bound, unbound_values)

@Predication(vocabulary, names=["_delete_v_1"])
def delete_v_1_comm(context, state, e_introduced_binding, x_actor_binding, x_what_binding):
    def criteria(value):
        # Only allow deleting files and folders that exist
        # value will not be a tuple since individual_style_predication_1() was used
        if value in state.all_individuals():
            return True

        else:
            context.report_error(["cantDo", "delete", x_what_binding.variable.name])

    def unbound_what():
        context.report_error(["cantDo", "delete", x_what_binding.variable.name])

    for success_state in individual_style_predication_1(context,
                                                        state, 
                                                        x_what_binding,
                                                        criteria, 
                                                        unbound_what,
                                                        ["cantXYTogether", "delete", x_what_binding.variable.name]):
        object_to_delete = success_state.get_binding(x_what_binding.variable.name).value[0]
        operation = DeleteOperation(object_to_delete)
        yield success_state.apply_operations([operation])
</code></pre></div></div>

<p>… and create our initial <code class="language-plaintext highlighter-rouge">State</code> object with the starting list of files:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def reset():
    return State(["file1.txt", "file2.txt", "file3.txt"])
</code></pre></div></div>

<p>With those changes, we can now test the system:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python hello_world.py
? a file is large
Yes, that is true.

? delete a large file
Done!

? a file is large
a file is not large
</code></pre></div></div>

<p>The last line confirms that the one large file in the system has been deleted.</p>

<p>Last update: 2024-10-14 by Eric Zinda [<a href="https://github.com/EricZinda/Perplexity/edit/main/docs/pxHowTo/pxHowTo070ActionVerbs.md">edit</a>]</p>

        
      </section>

      <footer class="page__meta">
        
        


        


      </footer>

      

      
    </div>

    
  </article>

  
  
</div>

<!--Scroll the navbar to the current page-->
<script type="text/javascript">
  let el = document.querySelector('.nav__list .active');
  if(el){
    el.scrollIntoView({block: "center", inline: "start"});
  }
</script>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/Perplexity/home/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 Your Name. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/Perplexity/home/assets/js/main.min.js"></script>




<script src="/Perplexity/home/assets/js/lunr/lunr.min.js"></script>
<script src="/Perplexity/home/assets/js/lunr/lunr-store.js"></script>
<script src="/Perplexity/home/assets/js/lunr/lunr-en.js"></script>







  </body>
</html>
